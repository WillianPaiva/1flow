{% extends 'home.html' %}
{% block title %}{% trans "Import contacts" %}{% endblock title %}
{% block body_id %}import-contacts{% endblock body_id %}

{% block application_content %}

<div class="spacer50"></div>

<div class="row-fluid">
	<div class="hero-unit span6 offset3">

{% if imported or dupes %}

	<h1>{% trans "Success" %}</h1>
	<div class="spacer25"></div>

	{# Note: The SPAN inside the P avoids the tooltip to show up at the edge of the .hero-unit DIV. #}

	{% if imported %}

		{% if dupes %}

		<p>{% blocktrans %}
			<strong>{{ imported }} new contact(s) imported.</strong></p><p>
			{{ dupes }} were already in your address book.</p><p>

			You can <a href="javascript:window.open('', '_self', '');window.close()">close this window/tab</a>.

		{% endblocktrans %}</p>

		{% else %}

			<p>{% blocktrans %}
				<strong>{{ imported }} new contact(s) imported.</strong></p><p>

				You can <a href="javascript:window.open('', '_self', '');window.close()">close this window/tab</a>.

			{% endblocktrans %}</p>

		{% endif %}

	{% else %}
		{# We have only dupes. #}

			<p>{% blocktrans %}
				<strong>All {{ dupes }} contact(s) were already in your address book.</strong></p><p>

				You can <a href="javascript:window.open('', '_self', '');window.close()">close this window/tab</a>.

			{% endblocktrans %}</p>

	{% endif %}

{% else %}

	<h1>{% trans "Bummer!" %}</h1>
	<div class="spacer25"></div>

	<p>{% blocktrans %}

		<strong>We were not able to import any contact.</strong></p><p>

		Either your remote address book is empty, or something went wrong with your webservice provider. Anyway, we are sorry for that.</p><p>

		Please retry later. Get in touch with our support if it fails again.</p><p>

		<a href="javascript:window.open('', '_self', '');window.close()">Close this window/tab.</a>

	{% endblocktrans %}</p>

{% endif %}

	</div>

{% if mongodb_user.is_staff_or_superuser_and_enabled and article %}
</div>
<div class="row-fluid">
	<div class="hero-unit span8 offset2 centered">

		<p>{% trans "Admin stuff:" %}
			<a href="{{ settings.NONREL_ADMIN }}article/{{ article.id }}"
				target="_blank">{{ article.title }} â€“ {{ article.id }}</a>
		</p>

	</div>
{% endif %}

</div>
{% endblock application_content %}

{% block extrajs_footer %}

    {{ block.super }}
    {% compressed_js 'read-one' %}

    <script type="text/javascript">

        common_init();

        {% if article %}

			$(document).ready(function(){
				var poll_article_status = function() {

					$.get("{{ poll_url }}", function(data) {
						if (data.indexOf('http') == 0) {
							document.location = data;
						}
					});

					setTimeout(poll_article_status, 1000);
				}

				setTimeout(poll_article_status, 1000);
			});

        {% endif %}

    </script>{% endblock extrajs_footer %}
