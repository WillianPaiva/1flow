{% extends 'base.html' %}
{% load raven django_select2_tags %}

{% block body_id %}home{% endblock body_id %}

{% block title %}{% trans 'Home' %}{% endblock title %}

{% block extrajs_header %}
    {{ block.super }}

    {% if config.WEB_CDNS_ENABLE %}

        <link rel="stylesheet" type="text/css"
            href="//cdn.jsdelivr.net/pnotify/1.2/jquery.pnotify.default.css" />

    {% else %}

        <link rel="stylesheet" type="text/css"
            href="{{ STATIC_URL}}/vendor/pnotify/1.2/jquery.pnotify.default.css" />

    {% endif %}

    {% comment %}
        <link rel="stylesheet" type="text/css"
            href="http://fonts.googleapis.com/css?family=Bitter:300,400" />

        <link rel="stylesheet" type="text/css"
            href="http://fonts.googleapis.com/css?family=Lato:300,400" />

        <!-- ,700,900,300italic,400italic,700italic,900italic -->
    {% endcomment %}

    {# TODO: include this in PIPELINE if possible #}

{% endblock extrajs_header %}

{% block body %}
  {% block application_header %}{% endblock application_header %}

  <section class="container">
    {# <div id="notifications" class="row-fluid hide"></div> #}

    {% if messages %}
        <script type="text/javascript">
            $(document).ready(function(){

            {% for message in messages %}
                {% with message.tags as tags %}

                    notify({
                        text: {% if 'safe' in tags %}"{{ message|safe }}"{% else %}"{{ message }}"{% endif %},
                        type: "{% if 'warning' in tags %}warning{% elif 'success' in tags %}success{% else %}info{% endif %}",
                        icon: false,

                        // The play/pause button, to keep auto-hiding
                        //notifications on screen before they disappear.
                        sticker: false,

                        // auto-hide or not.
                        hide: {% if 'sticky' in tags %}false{% else %}true{% endif %}
                    });

                {% endwith %}
            {% endfor %}

            });
        </script>
    {% endif %}

    <div class="application" id="application">

    {% block application_content %}

        {% include 'snippets/wizards/welcome-beta/welcome-beta.html' %}

    {% endblock application_content %}
    </div>
  </section>

  {% block application_footer %}{% endblock application_footer %}

  {% block web_item_importer %}
    {% cache 86400 base_web_item_importer %}
      {% include 'snippets/selector/import-web-items-trigger.html' %}
    {% endcache %}
  {% endblock web_item_importer %}

{% endblock body %}

{% block extrajs_footer %}

    {% cache 86400 home_extrajs_footer_immutable %}

        {{ block.super }}

        {% if config.WEB_CDNS_ENABLED %}

            <script type="text/javascript"
                src="//cdnjs.cloudflare.com/ajax/libs/raven.js/1.0.8/raven.min.js"></script>
            <script type="text/javascript"
                src="//cdn.jsdelivr.net/underscorejs/1.5.1/underscore-min.js"></script>
            <script type="text/javascript"
                src="//cdn.jsdelivr.net/mousetrap/1.4.2/mousetrap.min.js"></script>
            <script type="text/javascript"
                src="//cdn.jsdelivr.net/hammerjs/1.0.5/hammer.min.js"></script>
            <script type="text/javascript"
                src="//cdn.jsdelivr.net/pnotify/1.2/jquery.pnotify.js"></script>
            <script type="text/javascript"
                src="//cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
            <script type="text/javascript"
                src="//cdnjs.cloudflare.com/ajax/libs/jquery-color/2.1.2/jquery.color.min.js"></script>

        {% else %}
            {% compressed_js 'vendor-global' %}
        {% endif %}

        {# I didn't find CDNs for these; or some are our own files. #}
        {% compressed_js 'vendor-local' %}

        <script type="text/javascript">
            Raven.config('{% sentry_public_dsn %}').install();
        </script>

        {# NOTE: JS inclusion order matters. #}
        {% django_js jquery=false %}

        {% import_django_select2_js %}

    {% endcache %}

    {% cache 3600 home_extrajs_footer_mutable LANGUAGE_CODE %}
        {% include "snippets/home/extrajs-footer.js.html" %}
    {% endcache %}

{% endblock extrajs_footer %}
